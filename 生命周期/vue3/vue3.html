<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>vue3ç”Ÿå‘½å‘¨æœŸ</title>
  <script src="../../lib/vue.global.js"></script>
</head>

<body>
  <div id="app" v-if="showApp">
    <div ref="msgRef">{{msg}}</div>
    <children :title="msg" @update-title="updateTitle" v-if="show"></children>
    <button @click="showMsg">æ˜¾ç¤º</button>
    <button @click="hidden">éšè—</button>
    <button @click="hiddenApp">éšè—App</button>
  </div>

  <script>
    const { createApp, ref, onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } = Vue

    const children = {
      template: `<div>
          <div>å­ç»„ä»¶-{{title}}</div>
          <div>count: {{count}}</div>
          <button @click="updateTitle">ä¿®æ”¹title</button>
          <button @click="add">+1</button>
        </div>`,
      props: {
        title: {
          type: String,
          default: ""
        }
      },
      setup(props, context) {
        const count = ref(0)

        const add = () => {
          count.value++
        }

        const updateTitle = (str) => {
          context.emit("update-title", `hello world${Math.random()}`)
        }

        console.log("ğŸš€ ~ vue2.html ~ setup:", 'å­ç»„ä»¶åˆå§‹åŒ–')

        onBeforeMount(() => {
          console.log("ğŸš€ ~ vue2.html ~ onBeforeMount:", 'å­ç»„ä»¶æŒ‚è½½å‰')
        })

        onMounted(() => {
          console.log("ğŸš€ ~ vue2.html ~ onMounted:", 'å­ç»„ä»¶æŒ‚è½½å®Œæˆ')
        })

        onBeforeUpdate(() => {
          console.log("ğŸš€ ~ vue2.html ~ onBeforeUpdate:", 'å­ç»„ä»¶æ›´æ–°å‰')
        })

        onUpdated(() => {
          console.log("ğŸš€ ~ vue2.html ~ onUpdated:", 'å­ç»„ä»¶æ›´æ–°å®Œæˆ')
        })

        onBeforeUnmount(() => {
          console.log("ğŸš€ ~ vue2.html ~ onBeforeUnmount:", 'å­ç»„ä»¶é”€æ¯å‰')
        })

        onUnmounted(() => {
          console.log("ğŸš€ ~ vue2.html ~ onUnmounted:", 'å­ç»„ä»¶é”€æ¯å®Œæˆ')
        })

        return {
          count,
          add,
          updateTitle
        }
      }
    }

    createApp({
      components: {
        children
      },
      setup() {
        const msg = ref("hello world")
        const show = ref(true)
        const showApp = ref(true)
        const msgRef = ref()

        const showMsg = () => {
          window.alert(msg.value)
        }

        const updateTitle = (str) => {
          msg.value = str
        }

        const hidden = () => {
          show.value = false
        }

        const hiddenApp = () => {
          showApp.value = false
          console.log(showApp.value)
        }

        console.log("ğŸš€ ~ vue2.html ~ setup:", 'ç»„ä»¶åˆå§‹åŒ–')

        onBeforeMount(() => {
          console.log("ğŸš€ ~ vue2.html ~ onBeforeMount:", 'ç»„ä»¶æŒ‚è½½å‰', msg.value)
        })

        onMounted(() => {
          console.log("ğŸš€ ~ vue2.html ~ onMounted:", 'ç»„ä»¶æŒ‚è½½å®Œæˆ')
        })

        onBeforeUpdate(() => {
          console.log("ğŸš€ ~ vue2.html ~ onBeforeUpdate:", 'ç»„ä»¶æ›´æ–°å‰')
        })

        onUpdated(() => {
          console.log("ğŸš€ ~ vue2.html ~ onUpdated:", 'ç»„ä»¶æ›´æ–°å®Œæˆ')
        })

        onBeforeUnmount(() => {
          console.log("ğŸš€ ~ vue2.html ~ onBeforeUnmount:", 'ç»„ä»¶é”€æ¯å‰')
        })

        onUnmounted(() => {
          console.log("ğŸš€ ~ vue2.html ~ onUnmounted:", 'ç»„ä»¶é”€æ¯å®Œæˆ')
        })

        return {
          msg,
          show,
          showApp,
          showMsg,
          updateTitle,
          hidden,
          hiddenApp
        }
      }
    }).mount("#app")
  </script>
</body>

</html>