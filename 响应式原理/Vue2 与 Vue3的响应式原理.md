### Vue2 与 Vue3的响应式原理

vue2是通过数据劫持结合发布订阅模式实现响应式的

- 数据劫持：object.defineProperty()会给初始化的数据对象的属性都加上getter和setter方法，从而变成响应式数据，读取数据时触发getter，修改数据时触发setter。
- 发布订阅者模式：发布订阅其实是依赖观察者（observer）实现的。在遍历初始化的数据对象时，不止给属性添加了getter，setter方法，还给属性创建了一个观察者，当数据发生变化时也就是触发setter的时候，对应观察者就会通知那些依赖这个数据的地方进行更新。
- 需要遍历对象属性
- 初始化时遍历对象属性加上getter，setter方法对于深层嵌套耗性能，未初始化的属性没有get，set方法，非响应式数据
- 无法通过索引直接更新
- 嵌套太深层，无法响应
- 无法直接修改数组长度，需要借助数组方法实现

vue3是通过proxy代理实现响应式的，proxy可以代理整个对象，当访问属性时，会触发get方法，并且在这个阶段会进行依赖收集，也就是记录副作用函数与该属性的关系。当更新属性时，会触发set方法，通知那些依赖该属性的副作用函数执行。

- 惰性响应，访问时才会遍历对象属性，将其变成响应式对象，减少性能开销。
- 支持监听通过索引更新数组、数组长度调整以及动态添加删除属性。

